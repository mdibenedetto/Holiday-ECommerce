
@using dream_holiday.Controllers;
@using dream_holiday.Data;
@using dream_holiday.Models.EntityServices;

@inject UserResolverService _userResolverService;
@inject ApplicationDbContext _context;
@using Microsoft.AspNetCore.Identity

@inject ApplicationDbContext context

@{ 
    var cartService = new CartService(_context, _userResolverService);
    List<Cart> cartList = await cartService.GetCartUser();
}


<div class="order-md-2 mb-4">
    <h4 class="d-flex justify-content-between align-items-center mb-3">
        <span class="text-muted">Your cart</span>
        <span class="badge badge-secondary badge-pill">@cartList.Count()</span>
    </h4>
    <ul class="list-group mb-3">
        @{
            decimal totalPrice = 0;

            foreach (var cart in cartList)
            {
                <li class="list-group-item d-flex justify-content-between lh-condensed">
                    <div>
                        <h6 class="my-0"> @(cart.TravelPackage?.Name) </h6>
                        <small class="text-muted">
                            @cart.TravelPackage?.Country - @cart.TravelPackage?.City
                         </small>
                    </div>
                    <span class="text-muted"> @cart.Price &euro;</span>
                </li>

                totalPrice += cart.Price;
            }
        }
        <li class="list-group-item d-flex justify-content-between">
            <span>Total </span>
            <strong>@totalPrice &euro;</strong>
        </li>
    </ul> 
</div>
